import pandas as pd

# 예시 데이터
data = {
    "이름": ["철수","영희","민수","길동","미나","영수","수현","민지"],
    "학년": [1,1,2,2,3,3,2,1],
    "반":   [1,1,1,2,2,3,2,3],
    "국어": [90,85,70,95,60,75,80,88],
    "영어": [88,92,75,80,65,70,85,90],
    "수학": [95,80,88,70,90,85,75,92]
}
df = pd.DataFrame(data)
# 1) 학년별 평균 (국어/영어/수학)
# 2) 반별 수학 최고점
# 3) 학년+반별 영어 평균
# 4) 학년별 집계: 국어=평균, 영어=합계, 수학=최댓값
# 5) 학년별 학생 수
# 6) 반별 평균 수학 점수 내림차순 정렬
# 7) transform: 학년별 국어 평균 초과 여부
# 8) 학년별 영어 Top-1 학생

# 1) 학년별 평균 (국어/영어/수학)
ans1 = df.groupby("학년")[["국어","영어","수학"]].mean()

# 2) 반별 수학 최고점
ans2 = df.groupby("반")["수학"].max()

# 3) 학년+반별 영어 평균
ans3 = df.groupby(["학년","반"])["영어"].mean()

# 4) 학년별 집계: 국어=평균, 영어=합계, 수학=최댓값
ans4 = df.groupby("학년").agg(국어=("국어","mean"),
                               영어=("영어","sum"),
                                       수학=("수학","max"))

# 5) 학년별 학생 수
ans5 = df.groupby("학년").size()  # 또는 df.groupby("학년")["이름"].count()

# 6) 반별 평균 수학 점수 내림차순 정렬
ans6 = df.groupby("반")["수학"].mean().sort_values(ascending=False)

# 7) transform: 학년별 국어 평균 초과 여부
df["국어_평균초과"] = df["국어"] > df.groupby("학년")["국어"].transform("mean")
ans7 = df[["이름","학년","국어","국어_평균초과"]]

# 8) 학년별 영어 Top-1 학생
idx = df.groupby("학년")["영어"].idxmax()
ans8 = df.loc[idx, ["학년","이름","영어"]].sort_values("학년")

# 확인용 출력
print("[1] 학년별 평균\n", ans1, "\n")
print("[2] 반별 수학 최고점\n", ans2, "\n")
print("[3] 학년+반별 영어 평균\n", ans3, "\n")
print("[4] 학년별 집계\n", ans4, "\n")
print("[5] 학년별 학생 수\n", ans5, "\n")
print("[6] 반별 평균 수학 점수(내림차순)\n", ans6, "\n")
print("[7] 학년별 국어 평균 초과 여부(일부)\n", ans7, "\n")
print("[8] 학년별 영어 Top-1 학생\n", ans8, "\n")